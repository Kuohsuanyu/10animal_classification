# 10animal_classification
訓練一個模型用於辨識十種不同動物，使用公共資料集animal10
僅做為測試和學習流程故訓練結束後沒有再多準備測試即進行準確的正確率等數值測試

整體目標
這段程式碼的目標是使用預訓練的 EfficientNetB0 模型進行動物圖片的分類任務。通過載入已經在大型數據集（ImageNet）上訓練的 EfficientNetB0 作為基礎模型，再加上自定義的分類層和數據增強，來進一步訓練模型，使其適應特定的動物分類數據集。

1. 資料集路徑和影像基本參數設置
資料集路徑：指定圖片數據集所在的資料夾路徑。路徑中需要包含多個子資料夾，每個子資料夾代表一個類別。
影像大小：這裡設置為 224x224 像素，這是 EfficientNetB0 預設的輸入大小。對於其他影像大小，基礎模型可能無法處理，或需要額外調整。
批次大小：定義每次訓練時處理的圖片數量（32）。批次大小越大，訓練速度越快，但需要更多記憶體。32 是一個相對穩定的值，適合大部分影像分類任務。
2. 數據增強與預處理
數據增強技術可以有效擴充數據集，讓模型學習更具泛化性的特徵，減少過擬合的風險。這裡使用了ImageDataGenerator進行增強和預處理。

像素值重調整：將像素值從0-255範圍縮放到0-1之間，有助於加速收斂並提高數值穩定性。
訓練/驗證拆分：將數據集劃分為訓練集（80%）和驗證集（20%），用於監測模型的訓練過程中的表現。
增強參數：
旋轉：隨機旋轉影像（上限20度），讓模型更具魯棒性。
平移：影像的水平和垂直方向隨機平移（最多20%），幫助模型學習不同位置的特徵。
翻轉：水平隨機翻轉圖片，適合於對稱類別（如動物圖片）。
生成的數據集會以批次形式輸入到模型中，每個批次包含隨機增強的圖片和對應的標籤。這樣可以在每個 epoch 中產生更多樣化的數據。

3. 模型選擇：EfficientNetB0
EfficientNetB0 是一個經典的影像分類模型，它在 ImageNet 上經過預訓練，對於特徵提取具有很強的能力。它是 EfficientNet 系列的最小模型，適合有限的計算資源。

這裡的設定：

預訓練權重：使用 ImageNet 上的預訓練權重。這樣模型已經具有對一般性影像特徵的識別能力，可以更快收斂。
不包含頂層：將原模型的頂層（分類層）移除，因為我們要添加自己的分類層來適應特定的動物分類任務。
4. 層解凍設定
為了使模型能更好地適應新的數據集，這裡選擇解凍 EfficientNetB0 的最後30層。這樣可以讓這些層的權重在訓練過程中進一步調整，更加專注於數據集中獨特的特徵。

解凍層數的選擇會影響模型的訓練效果和過擬合風險。解凍過少的層數會限制模型適應新的數據集；解凍過多則可能導致過擬合和訓練效率低下。

5. 添加自定義分類層
基礎模型（EfficientNetB0）之上添加了一組新的層，用來進行動物分類：

GlobalAveragePooling2D：將特徵圖壓縮為一個向量，這樣可以減少參數數量，防止過擬合。
Dropout (0.5)：隨機丟棄50%的神經元，減少過擬合的風險。
全連接層（Dense 256）：增加一層有256個神經元的全連接層，使用 ReLU 激活函數來學習更複雜的特徵。
再次Dropout (0.5)：再次丟棄50%的神經元，進一步減少過擬合風險。
輸出層（Dense 10）：最終的輸出層，有10個神經元，代表10個分類（假設動物分類數為10），並使用 softmax 激活函數來輸出每個分類的概率。
這些層的組合使模型能夠在特定的動物分類任務上有效地學習和區分特徵。

6. 超參數設置
學習率：設置為 1e-5，這是一個較低的學習率，適合微調已經預訓練的模型，讓模型權重調整更加穩定。
批次大小：設定為 32，是一個相對穩定的值，能有效利用記憶體，同時保持計算效率。
訓練週期（epochs）：設置為 1000，以確保模型有足夠的時間收斂。
這些超參數的選擇平衡了模型的收斂速度和過擬合風險。

7. 回調函數
為了提高訓練穩定性並防止過度訓練，使用了兩個回調函數：

ReduceLROnPlateau：當驗證損失在10個epoch沒有改善時，自動降低學習率（乘以0.5），以便模型能更細緻地學習特徵，最小學習率設為 1e-6。
EarlyStopping：當驗證損失在30個epoch內沒有改善時停止訓練，並恢復到最佳權重，這樣可以節省訓練時間並防止過擬合。
這些回調函數幫助模型自適應調整學習率並及時停止訓練。

8. 訓練過程
在所有的設定完成後，模型進行訓練。訓練過程會輸出每個 epoch 的訓練損失和驗證損失、準確率等數據，以便觀察模型的收斂情況。訓練完成後，模型會保存至文件（animal10_efficientnet_finetuned.h5），以便後續使用或評估。

9. 視覺化訓練結果
使用 Matplotlib 將訓練過程中的損失和準確率變化繪製成圖表：

Training Loss vs. Validation Loss：觀察模型損失的收斂情況，確保模型逐漸收斂並且過擬合程度可控。
Training Accuracy vs. Validation Accuracy：觀察準確率變化，確認模型是否在穩定提升。
這些圖表能幫助後續分析模型在訓練過程中的表現和狀態。

10. 模型最終評估
使用訓練集和驗證集進行模型的最終性能評估，輸出最終的損失和準確率，用於檢查模型在訓練過程結束時的表現。
